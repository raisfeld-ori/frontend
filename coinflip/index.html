<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coinflip - 67 Casino</title>
    <meta name="theme-color" content="#7c3aed">
    <meta name="description" content="Coinflip game at 67 Casino">
    <font name="inter" src="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2" />
    <style>
        body { 
            font-inter 
            bg-[#0a0a0a] 
            text-white 
            m-0 
            p-0 
            min-h-screen
        }
    </style>
            <script>
    local balance = gurt.crumbs.get("balance")
    if balance == nil then
        gurt.crumbs.set({
            name = "balance",
            value = 100
        })
        balance = 100
    end
    local element = gurt.select('#wallet-balance')
    element.text = balance
    </script>
    <script>
        -- Coinflip Game Logic
        local gameStats = {
            wins = 0,
            losses = 0,
            total = 0
        }
        local isFlipping = false

        -- Get DOM elements
        local coin = gurt.select('#coin')
        local result = gurt.select('#result')
        local flipButton = gurt.select('#flipButton')
        local choiceSelect = gurt.select('#choice-select')
        local betInput = gurt.select('#bet-input')
        local winsDisplay = gurt.select('#wins-count')
        local lossesDisplay = gurt.select('#losses-count')
        local totalDisplay = gurt.select('#total-count')

        -- Update stats display
        local function updateStats()
            winsDisplay.text = tostring(gameStats.wins)
            lossesDisplay.text = tostring(gameStats.losses)
            totalDisplay.text = tostring(gameStats.total)
        end

        -- Main flip function
        local function flipCoin()
            if isFlipping then
                return
            end
            
            -- Get user inputs
            local userChoice = choiceSelect.value
            local betText = betInput.value
            local betAmount = tonumber(betText)
            local currentBalance = tonumber(gurt.crumbs.get("balance"))
            
            -- Validate inputs
            if betAmount == nil or betAmount - 1 >= currentBalance or betAmount <= 0 then
                result.text = "Enter a valid bet amount"
                result.style = "text-2xl font-bold text-[#ef4444] mb-8"
                return
            end
            
            if currentBalance - 1 <= betAmount then
                result.text = "Not enough balance"
                result.style = "text-2xl font-bold text-[#ef4444] mb-8"
                return
            end
            
            -- Start flipping
            isFlipping = true
            flipButton.text = "Flipping..."
            result.text = "Flipping..."
            result.style = "text-2xl font-bold text-[#fbbf24] mb-8"
            
            -- Coin animation
            local animCount = 0
            local animation = setInterval(function()
                animCount = animCount + 1
                if animCount % 2 == 0 then
                    coin.text = "6"
                    coin.style = "w-[300px] h-[300px] rounded-full bg-[#ffd700] border-4 border-[#f59e0b] text-4xl font-bold text-[#92400e] cursor-pointer mx-auto flex items-center justify-center"
                else
                    coin.text = "7"
                    coin.style = "w-[300px] h-[300px] rounded-full bg-[#d1d5db] border-4 border-[#9ca3af] text-4xl font-bold text-[#374151] cursor-pointer mx-auto flex items-center justify-center"
                end
            end, 100)
            
            -- Get random result
            local coinResult = math.random(0, 1)
            
            -- Stop animation and show result
            setTimeout(function()
                clearInterval(animation)
                
                -- Check if user won
                local won = false
                if (userChoice == "6" and coinResult == 0) or (userChoice == "7" and coinResult == 1) then
                    won = true
                end
                
                -- Update balance
                local newBalance = currentBalance
                if won then
                    newBalance = newBalance + betAmount
                    gameStats.wins = gameStats.wins + 1
                else
                    newBalance = newBalance - betAmount
                    gameStats.losses = gameStats.losses + 1
                end
                gameStats.total = gameStats.total + 1
                
                -- Save new balance
                gurt.crumbs.set({
                    name = "balance",
                    value = newBalance
                })
                local balanceElement = gurt.select('#wallet-balance')
                balanceElement.text = tostring(newBalance)
                
                -- Show final coin state
                if coinResult == 0 then
                    coin.text = "6"
                    coin.style = "w-[300px] h-[300px] rounded-full bg-[#ffd700] border-4 border-[#f59e0b] text-4xl font-bold text-[#92400e] cursor-pointer mx-auto flex items-center justify-center"
                else
                    coin.text = "7"
                    coin.style = "w-[300px] h-[300px] rounded-full bg-[#d1d5db] border-4 border-[#9ca3af] text-4xl font-bold text-[#374151] cursor-pointer mx-auto flex items-center justify-center"
                end
                
                -- Show result message
                if won then
                    result.text = "You Won " .. betAmount .. " chips"
                    result.style = "text-2xl font-bold text-[#10b981] mb-8"
                else
                    result.text = "You Lost " .. betAmount .. " chips"
                    result.style = "text-2xl font-bold text-[#ef4444] mb-8"
                end
                
                -- Update display
                updateStats()
                flipButton.text = "Flip Again"
                isFlipping = false
                
                trace.log("Flip complete - Result: " .. (coinResult == 0 and "6" or "7") .. " Won: " .. tostring(won))
            end, 1500)
        end

        -- Event listeners
        flipButton:on('click', flipCoin)
        coin:on('click', flipCoin)

        -- Initialize
        math.randomseed(Time.now())
        updateStats()
        
        trace.log("Coinflip initialized")
    </script>
        <script>
    -- Navigation event handlers
    local navHome = gurt.select('#nav-home')
    local navSlots = gurt.select('#nav-slots')
    local navBlackjack = gurt.select('#nav-blackjack')
    local navRoulette = gurt.select('#nav-roulette')
    local navPoker = gurt.select('#nav-poker')
    local navDice = gurt.select('#nav-dice')
    local navCoinflip = gurt.select('#nav-coinflip')
    
    navHome:on('click', function() gurt.location.goto('/') end)
    navSlots:on('click', function() gurt.location.goto('/slots') end)
    navBlackjack:on('click', function() gurt.location.goto('/blackjack') end)
    navRoulette:on('click', function() gurt.location.goto('/roulette') end)
    navPoker:on('click', function() gurt.location.goto('/poker') end)
    navDice:on('click', function() gurt.location.goto('/dice') end)
    navCoinflip:on('click', function() gurt.location.goto('/coinflip') end)
    </script>
</head>
<body>
     <!-- Top Navigation Bar -->
    <div style="bg-[#111111] p-4 border-b border-[#333333]">
        <div style="flex justify-between items-center max-w-6xl mx-auto">
            <!-- Casino Brand -->
            <div style="flex items-center">
                <span style="text-xl font-bold mr-8 text-white">67 Casino</span>
            </div>
            
            <!-- Menu Navigation -->
            <div style="flex items-center">
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-home">Home</span>
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-slots">Slots</span>
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-blackjack">Blackjack</span>
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-roulette">Roulette</span>
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-poker">Poker</span>
                <span style="text-[#888888] cursor-pointer mx-4 hover:text-white no-underline" id="nav-dice">Dice</span>
                <span style="text-white cursor-pointer mx-4 hover:text-[#7c3aed] no-underline" id="nav-coinflip">CoinFlip</span>
            </div>
            
            <!-- Gurt Wallet Balance (Far Right) -->
            <div style="flex items-center ml-8">
                <div style="bg-[#2a2a2a] rounded-lg px-4 py-2 border border-[#444444] flex items-center gap-3">
                    <!-- Coin Icon -->
                    <div style="w-6 h-6 rounded-full bg-[#ffd700] border-2 border-[#ffed4e] text-[#8b4513] text-xs font-bold text-center">
                        G
                    </div>
                    <!-- Balance -->
                    <span style="text-white font-bold" id="wallet-balance">test</span>
                    <!-- Add Button -->
                    <button style="w-6 h-6 bg-[#555555] text-white text-sm font-bold cursor-pointer hover:bg-[#666666] border-none">
                        +
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Centered Game Container -->
    <div style="min-h-[calc(100vh-80px)] p-8">
        <div style="w-full max-w-4xl mx-auto text-center pt-16">
            <!-- Game Title -->
            <h1 style="text-6xl font-bold text-white mb-4 mx-auto">Coinflip</h1>
            <p style="text-xl text-[#888888] mb-16 mx-auto">Click the coin or button to flip!</p>
            
            <!-- Coin Container -->
            <div style="mb-16">
                <div id="coin" style="w-[300px] h-[300px] rounded-full bg-[#FFD700] border-4 border-[#FFA500] text-2xl font-bold text-[#8B4513] cursor-pointer mx-auto pt-[130px] text-center">
                    GURT
                </div>
            </div>

            <!-- Game Controls -->
            <div style="mb-12">
                <div style="bg-[#1a1a1a] border border-[#333333] rounded-xl p-6 max-w-md mx-auto">
                    <div style="mb-4">
                        <p style="text-lg font-medium text-white mb-2">Choose your prediction:</p>
                        <select id="choice-select" style="w-full p-3 bg-[#2a2a2a] border border-[#444444] rounded-lg text-white">
                            <option value="option1">6</option>
                            <option value="option2">7</option>
                        </select>
                    </div>
                    <div id="origin-container" style="flex flex-col gap-2">
                        <p id="origin-text" style="text-lg font-medium text-white mb-2">Chips to be bet:</p>
                        <input id="bet-input" type="number" placeholder="0" style="text-white" />
                    </div>
                </div>
            </div>
            

            <!-- Result Display -->
            <div id="result" style="text-3xl font-bold text-white mb-12 min-h-[3rem] mx-auto text-center"></div>
            
            <!-- Flip Button -->
            <button id="flipButton" style="bg-[#7c3aed] text-white px-12 py-6 rounded-xl text-2xl font-bold cursor-pointer hover:bg-[#8b5cf6] border-none mb-16 mx-auto block">
                Flip Coin
            </button>
            
            <!-- Stats Grid -->
            <div style="max-w-3xl mx-auto mb-12 text-center overflow-hidden">
                <div style="bg-[#1a1a1a] border border-[#333333] rounded-xl p-6 text-center m-2 w-[170px] float-left">
                    <div style="text-3xl font-bold text-[#10b981] mb-2" id="wins-count">0</div>
                    <div style="text-[#888888] text-lg">Wins</div>
                </div>
                <div style="bg-[#1a1a1a] border border-[#333333] rounded-xl p-6 text-center m-2 w-[170px] float-left">
                    <div style="text-3xl font-bold text-[#ef4444] mb-2" id="losses-count">0</div>
                    <div style="text-[#888888] text-lg">Losses</div>
                </div>
                <div style="bg-[#1a1a1a] border border-[#333333] rounded-xl p-6 text-center m-2 w-[170px] float-left">
                    <div style="text-3xl font-bold text-white mb-2" id="total-count">0</div>
                    <div style="text-[#888888] text-lg">Total</div>
                </div>
            </div>
            
            <!-- Back to Games -->
            <div style="text-center mx-auto">
                <a href="/" style="text-[#7c3aed] hover:text-[#8b5cf6] cursor-pointer text-xl">← Back to Games</a>
            </div>
        </div>
    </div>
</body>
</html>